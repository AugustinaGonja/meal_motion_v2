<!-- Search Bar-->
<div class="search-bar-top">
  <div class="container-fluid py-2">
    <form method="GET" action="{% url 'products' %}">
      <div class="input-group input-group-sm">
        <input class="form-control" type="search" name="q" placeholder="Search for Products..." aria-label="Search">
        <button class="btn search-btn def-btn text-uppercase" type="submit">
          <i class="fa-solid fa-magnifying-glass fa-lg"></i>
        </button>
      </div>
    </form>
  </div>
</div>
<nav class="navbar fixed-top navbar-expand-lg shadow-sm custom-nav">
  <div class="container-fluid d-flex align-items-center">
    <div class="d-flex align-items-center order-1">
      
      <!-- Toggler for mobile -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
        aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Logo -->
      <a class="navbar-brand" href="{% url 'home' %}">
        <i class="fa-solid fa-utensils fa-sm m-3"></i>
        MEALMOTION
      </a>
    </div>

    <!-- Collapsible Content -->
    <div class="collapse navbar-collapse order-3 order-lg-2 justify-content-center" id="mainNav">
      <ul class="navbar-nav mx-auto gap-2 gap-lg-3 text-center align-items-center">
        <li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Home</a></li>
        
        <!-- Shop Dropdown -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="{% url 'products' %}" id="shopDropdown" role="button" data-bs-toggle="dropdown"
            aria-expanded="false">Fitness & Nutrition Shop</a>
          <ul class="dropdown-menu dropdown-nav-mobile w-100" aria-labelledby="shopDropdown">
            <li><a class="dropdown-item fw-bold" href="{% url 'products' %}">All Products</a></li>
            <li><a class="dropdown-item" href="{% url 'products' %}?category=supplement">Supplements</a></li>
            <li><a class="dropdown-item" href="{% url 'products' %}?category=hydration">Hydration</a></li>
            <li><a class="dropdown-item" href="{% url 'products' %}?category=fitness_equipment">Fitness Equipment</a>
            </li>
            <li><a class="dropdown-item" href="{% url 'products' %}?category=kitchen_tools">Kitchen Tools</a></li>
          </ul>
        </li>

        <!-- Recipe Dropdown -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="{% url 'recipes' %}" id="recipeDropdown" role="button" data-bs-toggle="dropdown"
            aria-expanded="false">Recipe Catalogue</a>
          <ul class="dropdown-menu dropdown-nav-mobile w-100" aria-labelledby="recipeDropdown">
            <li><a class="dropdown-item fw-bold" href="{% url 'recipes' %}">All Recipes</a></li>
            <li><a class="dropdown-item" href="{% url 'recipes' %}?category=contains_meat">Meaty Dishes</a></li>
            <li><a class="dropdown-item" href="{% url 'recipes' %}?category=high_protein">High Protein</a></li>
            <li><a class="dropdown-item" href="{% url 'recipes' %}?category=vegetarian">Vegetarian</a></li>
            <li><a class="dropdown-item" href="{% url 'recipes' %}?category=low_calorie">Low Cal</a></li>
            <li><a class="dropdown-item" href="{% url 'recipes' %}?category=fish_and_seafood">Fish & Seafood</a></li>
          </ul>
        </li>

        <!-- Regular Links -->
        {% if user.is_authenticated %}
        <li class="nav-item"><a class="nav-link" href="{% url 'account_logout' %}">Logout</a></li>
        {% else %}
        <li class="nav-item"><a class="nav-link" href="{% url 'account_signup' %}">Membership</a></li>
        {% endif %}
      </ul>
    </div>

    <!-- Nav Icons -->
    <div class="d-flex align-items-center gap-3 order-2 order-lg-3 ms-auto flex-nowrap">
      {% if user.is_authenticated %}
      {% if user.is_superuser %}
      <div class="nav-icon">
        <a href="#" class="text-reset">
          <i class="fa-solid fa-gears fa-xl mx-3"></i>
        </a>
        <a href="#" class="text-reset">
          <i class="fa-solid fa-user fa-lg"></i>
        </a>
      </div>
      {% else %}
      <div class="nav-icon">
        <a href="#" class="text-reset">
          <i class="fa-solid fa-user fa-lg"></i>
        </a>
      </div>
      {% endif %}
      {% else %}
      <a href="{% url 'account_login' %}" class="text-reset">
        <i class="fa-solid fa-user fa-lg"></i>
      </a>
      {% endif %}
      <div class="nav-icon position-relative">
        <a href="{% url 'bag' %}" class="text-reset text-decoration-none">
          {% if grand_total %}
          <i class="fa-solid fa-bag-shopping fa-bounce fa-lg bag"></i>
          {% else %}
          <i class="fa-solid fa-bag-shopping fa-lg"></i>
          {% endif %}
        </a>
      </div>
    </div>
  </div>
</nav>